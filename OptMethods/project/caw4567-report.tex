\documentclass[11pt]{article}

\usepackage{thumbpdf, amssymb, amsmath, amsthm, microtype,
	    graphicx, verbatim, listings, color, fancybox}
\usepackage[pdftex]{hyperref}
%\usepackage[margin=1in]{geometry}
\usepackage{cawsty}
\usepackage{fullpage}
\usepackage{pseudocode}

\newcommand{\field}[1]{\mathbb{#1}} %requires amsfonts

%\setlength{\parindent}{0pt}

\linespread{1.2}

\begin{document}
\arltitle{4040-849 Optimization Methods}{Optimizing Cryptographic Strength of Substitution Layers in Symmetric-Key Cryptosystems}

%TODO: define boolean function
\begin{abstract}
Cryptographically secure block ciphers are based around Shannon's principles of confusion and diffusion \cite{Kim90astudy}. It is important to optimize these characteristics in order to make ciphers less susceptible to linear and differential cryptanalysis attacks. The most traditional way to integrate mathematical structures that improve the confusion of a block cipher is to use a substitution box (or simply, an S-box). Recent research efforts have revealed practical measurements of S-box constructions that indicate their susceptibility to linear and differential cryptanalysis. In this work, we attempt to formulate the problem of cryptographically strong S-box designs (and subsequently, any confusion layer design) into a mixed integer programming problem that can be optimized to yield the high diffusion and confusion dividends in resulting cipher implementations.
\end{abstract}

%TODO: cost functions? multiple, optimize BN/nonlinearity/DPP 
%TODO: design variables must then be elements in the field

\section{Block Cipher Security and Linear Cryptanalysis}

%TODO: find a way to introduce linear cryptanalysis

%GOAL: THIS SECTION IS ABOUT BLOCK CIPHER SECURITY, LINEAR AND DIFFERENTIAL CRYPTANALYSIS TECHNIQUES, WHY NONLINEARITY IS IMPORTANT AND SAC ARE IMPORTANT
Ever since the application of linear cryptanalysis on the FEAL and DES block ciphers in the early ninties, nonlinearity has become a essential characteristic of any secure symmetric-key cryptographic algorithm design (especially block ciphers) \cite{Heys01atutorial}. Linear cryptanalysis is a cryptanalytic attack that attempts to take advantage of high probability occurrences of linear expressions involving plaintext bits, ciphertext bits, and subkey bits. Mathematically, the attack is based on the idea of approximating the operation of a portion of the block cipher in question with an expression that is linear in terms of the bits of the inputs ($X$) and outputs ($Y$) involved, as shown below \cite{Heys01atutorial}:
\begin{eqnarray*}
X_{i_{1}} \oplus X_{i_{2}} ... \oplus X_{i_{r}} \oplus Y_{j_{1}} \oplus Y_{j_{2}} ... \oplus Y_{j_{s}} \oplus  = 0
\end{eqnarray*}
Using this expression, attackers can guage the amount of randomness introduced by the cipher. That is, if such an expression occurrs frequently with a relatively high probability, then we know that the probability of the expression holding for any two values $a,b\in \field{F}_2^n$ is approximately $\frac{1}{2}$. However, when this probability shifts away from $\frac{1}{2}$, the amount of known plaintexts required to determine the key (or key block) that was used to reproduce the output goes down dramatically. Thus, such a deviation from the expected probability of $\frac{1}{2}$ for any expression of the form above, which is referred to as the \emph{linear bias}, determines the susceptibility of the block cipher to known plaintext attacks. Consequently, it is important to introduce a great deal of nonlinearity into the block cipher in order to thwart such attacks.

In traditional block ciphers based on substitution-permitatuon networks (such as the DES and AES), the S(ubstitution)-box is the primary source of nonlinearity that is designed to thwart such cryptanalysis attacks. An S-box is a bijective function $f$ defined over $\field{F}_2^n$ that maps elements in its domain to distinct elements in the range. Rijndael, the AES algorithm, was selected as the finalist in the AES competition due to its simplistic design, implementation metrics, and strong security properties. Perhaps the most notable element of its security is the S-box design it uses to achieve nonlinearity. Mathematically, the substitution of a single element $a \in \field{F}_2^n$ is computed by performing an affine transformation on $a^{-1}$ (the multiplicative inverse of $a$). The affine transformation was carefully constructed to yield high resistance against known cryptanalytic attacks of the time, including both linear and differential cryptanalysis \cite{Daemen:2002:DRA}. 

S-boxes are not the only proposed source of nonlinearity, however. One other notable deisgn technique is based on the notion of modular ($2^n$) addition, bit-wise rotation, and XOR operations. Separate, these simple routines are very easy to invert and fit to a linear model. However, when brought together in the right way using information from the secret key as an operand, an artificial degree of nonlinearity begins to emerge in the result. Threefish, the block cipher inside Skein (one of final candidates for the SHA-3 hash function competition), relies on the ARX operation for nonlinear behavior between rounds of the cipher. However, such designs are also susceptible to similar cryptanalytic attacks, as was shown in \cite{Khovratovich:2010:RCA:1876089.1876116}. Therefore, the focus and scope of this project will be geared towards S-box design due to its simplicity and cryptographic maturity.

Linear cryptanalysis is not the only attack that threatens existing block ciphers. Differential cryptanalysis is a very powerful attack technique that TODO: FINSIH THIS AND CONCLUDE THAT SAC IS NECESSARY

\section{Cryptographic Strength}
Mathematically, an S-box can be represented as a function $f$ that maps input values $a$ to output values $b$ such that $a,b \in \field{F}_2^n$. In cryptographic terms, such a function $f$ must be bijective in order to avoid bias towards any specific output element in the field. We now present a series of definitions that are pertinent to the design of cryptographically strong S-Boxes (and any confusion layer) \cite{Mar_newanalysis}.

%TODO: http://www.waset.org/journals/waset/v48/v48-24.pdf && thesis work

\begin{define}
The \emph{Hamming weight} of an element $a \in \field{F}_2^n$ is defined as wt$(x) = \sum x_i$.
\end{define}

\begin{define}
Let $f$ be a bijective function with range $\mathbb{R^*}$, where $|\mathbb{R^*}| = m$. Let $n$ be the number of elements $x$ that satisfy $f(x \oplus \Delta_i) = f(x) \oplus \Delta_o$. Then, $\frac{n}{m}$ is the \emph{differential probability p} of the characteristic $f_D(\Delta_i \to \Delta_o)$.
\end{define}

\begin{define}
The \emph{branch number} of an $n \times n$-bit S-Box is
\begin{eqnarray*}
BN = \text{min}_{a, b\not=a}(\text{wt}(a \oplus b) + \text{wt}(S(a) \oplus S(b))),
\end{eqnarray*}
where $a, b \in \field{F}_2^n$.
\end{define}

\begin{define}
A function $f : \field{F}_2^n \to \field{F}_2^n$ exhibits the \emph{avalanche effect} if and only if 
\begin{eqnarray*}
\sum_{x \in \field{F}_2^n} \text{wt}(f(x) \oplus f(x \oplus c_{i}^{n})) = n2^{n-1},
\end{eqnarray*}
for all $i (1 \leq i \leq n)$, where $c_{i}^{n} = [0, 0, ..., 1, ..., 0]$ (where a $1$ is in the $n$th position of the vector of cardinality $n$.
\end{define}

\begin{define}
A function $f : \field{F}_2^n \to \field{F}_2^n$ satisfies the \emph{Strict Avalanche Critertion (SAC)} if for all $i (1 \leq i \leq n)$ the following equations hold:
\begin{eqnarray*}
\sum_{x \in \field{F}_2^n} f(x) \oplus f(x \oplus c_i^n) = (2^{n-1}, 2^{n-1}, ..., 2^{n-1})
\end{eqnarray*}
This simply means that the $f(x) \oplus f(x \oplus c_i^n)$ is balanced for every element in $\field{F}_2^n$ with Hamming distance of $1$. 
\end{define}

\begin{define}
%Ideal construction of cryptographic primitives will utilize internal boolean functions that satisfy the SAC %criterion because they result in high levels of confusion, thus thwarting attempts by an attacker to %statistically relate the ciphertext of a cipher to the key that was used for encryption or decryption. However, %in order to prevent differential cryptanalysis attacks, it is important that these boolean functions also have a %high branch number.

%Strong S-Boxes also exhibit strong non-linearity properties \cite{Kim90astudy}. It has been shown by %Rueppel that the nonlinearity of a boolean function can be measured by the Hamming distance to the set of %affine transformations and is related to the Walsh transform $\hat{F}$ of $\hat{f} : \field{F}_2^n \to \{-1, %1\}$ according to:

TODO: define nonlienarity measurement here
\begin{eqnarray*}
\delta(f)  = 2^{n-1} - \frac{1}{2}\text{max}_w|\hat{F}(w)|,
\end{eqnarray*}
where $\hat{F}(w)$ is the Walsh transformation defined as follows:
\begin{eqnarray*}
W_f(a) = \sum_{x \in \field{F}_2^n} (-1)^{f(x) + <a,x>},
\end{eqnarray*}
where $<a,x>$ is the scalar product of $a$ and $x$ (if they are thought of as vectors).
\end{define}

Designers of cryptographically secure cryptographic primitives (e.g. block ciphers, hash functions, etc) use these measurements as a basis for their susceptibility to linear and differential cryptanalysis when constructing their algorithms. However, they place the additional constraint on such primitives that fast and simple mathematical operations must be used to emulate a bijective function $f$ that exhbits ideal properties for all of these values.

%As previously mentioned, S-Boxes have been the primary source of confusion in most cryptographic %primitives. However, some recently proposed cryptographic primitives (e.g. the Skein hash function %\cite{Ferguson09theskein}) are making use of an ARX (Addition, Rotation, and XOR) layer to provide similar %results. This design decision was driven by the lack of strict security proofs for S-Boxes and the %implementation efficiency of the ARX design. However, at an abstract level, an ARX layer can be represented %by a bijective function $f$ as well, thus making it applicable to this problem. However, because the security %of ARX confusion layers is not well understood and has only recently faced considerable cryptanalysis %research \cite{}, we restrict ourselves to S-Box designs.

\section{Optimization Candidate Description}
Cryptographically secure primitives utilize diffusion and confusion layers that provide the following characteristics:

\begin{enumerate}
	\item Low differential propagation probability
	\item High branch number
	\item Satisfaction of the SAC criterion
	\item High degree of non-linearity
\end{enumerate}

Therefore, it is natural to reduce the problem of finding an optimal confusion layer for cryptographic primitives to an integer programming problem that seeks to optimize each one of these construction dimensions. In other words, optimal confusion layer construction can be thought of an integer programming problem with multiple cost functions that share a single, balanced solution. The common solutions to these objectives (if they exist) are thus contained within the Pareto set for the problem.

In this work we will seek to abstract the construction of confusion layers away from the Boolean functions that they represent and optimize the representation of this function in order to achieve ideal values for aforementioned metrics. In other words, we focus on the construction of a function $f$ with finite domain and range (both of the same cardinality) that could potentially be realized by a mathematical operation or construction. Only the forward version of $f$ shall be considered in this construction. However, in practical settings, $f$ must be invertible to be applied in symmetric key cryptosystems. 

Therefore, the design variables pair-wise mappings of the bijective function $f$. In order to manage the complexity of the problem, only 4-bit layers will be considered (i.e. $|\mathbb{R^*}| = 2^4 = 16$).

\section{Programming Language Use}
The Optimization Toolkit will be utilized in conjunction with MatLab in order to perform the mathematical computations. In addition, Mathematica will be utilized to allow for easy data collection management and visualization during the course of the project. 

%TODO: include one more reputable source of information
\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
\bibliography{caw4567-report}

\begin{comment}
Key distribution is a vital part of wireless ad-hoc communication networks that need to transfer text, audio, and video data both securely and efficiently. Traditionally, key agreement protocols are based upon the commonly known Diffie Hellman key exchange protocol, in which two (or more) parties may exchange public information in order to establish a common key. The problem with this approach is that it is very computationally inefficient, and doesn't lend itself directly to the problem of establishing a single common group key among multiple parties in a group. This is especially true in wireless ad-hoc networks where the nodes themselves have constrained processing and power resources.

For this reason, key agreement schemes for this specific type of network typically rely on pre-placed information that can be easily distributed to members of the group in order to establish a common group key. Therefore, at the physical layer of the network, where the group topology is represented as a single spanning tree, it is important that the latency of sending data between two nodes is as small as possible in order to ensure the fastest transmission of data. Depending on the radio propagation model and specific waveform used to propagate the digital data via an analog signal to each of the nodes, the structure of this tree can have a drastic impact on the time it takes to distribute a specific piece of data from node to every other node in the group.

Therefore, the purpose of this project is to minimize the time it takes this data to transmit to every other node in the group depending on the following parameters:

\begin{enumerate}
	\item Number of slots available in the TDMA scheme 
	\item Maximum number of nodes in the network
	\item Maximum number of node children allowed in the spanning tree
	\item Data packet size
	\item Radio channel bandwidth
\end{enumerate}

%Find minimum key distribution times for spanning tree representation of wireless ad-hoc networks.
% 1. Design variables:
% number of slots available in TDMA scheme (if TDMA is taken into account)
% number of nodes in the network
% maximum number of node children allowed
% key packet size
% channel bandwidth
% 2. Constraints
% sum of children
% all node children <= max number of children
% #used TDAM slots <= #available TDMA slots
% #
\end{comment}

\end{document}
